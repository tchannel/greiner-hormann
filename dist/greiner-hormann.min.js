!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.ghClipping=e()}}(function(){return function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){var n=t[s][1][e];return o(n?n:e)},h,h.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t){t.exports={union:e("./lib/union"),intersect:e("./lib/intersect"),subtract:e("./lib/subtract"),utils:e("./lib/util")}},{"./lib/intersect":3,"./lib/subtract":5,"./lib/union":6,"./lib/util":7}],2:[function(e,t){function n(e,t){return e||t?e&&t?mode="intersect":!e&&t?mode="subtractB":e&&!t&&(mode="subtractA"):mode="union",mode}function r(e,t,n,r,o){var i=e.count(),s=t.count();if(0===e.count("intersect",!0))switch(o){case"union":return[[n],[r]];case"intersect":return[];case"subtractB":return"in"==t.first.type?[[n,r]]:e.count("type","in")==i?[]:[[n]];case"subtractA":return"in"==e.first.type?[[r,n]]:"in"==t.first.type?[]:[[r]]}if(i==e.count("degenerate",!0)||1==e.count("intersect",!0))switch(o){case"subtractA":return s==t.count("degenerate",!0)?[]:[[r]];case"subtractB":return s==t.count("degenerate",!0)?[]:[[n]];default:return[[n]]}}function o(e,t,n){for(var r=e.first,o=[],i=!1,s="next",a="prev";r=e.firstIntersect();){var l=[[r.x,r.y]];do{if(i?(s=n?"next":"prev",a=n?"prev":"next"):(s=t?"next":"prev",a=t?"prev":"next"),r.checked=!0,r.neighbor&&(r.neighbor.checked=!0),r.entry){do r=r[s],l.push([r.x,r.y]);while(!r.intersect)}else do r=r[a],l.push([r.x,r.y]);while(!r.intersect);r=r.neighbor,i=!i}while(!r.checked);if(v.pointsEqual(l[0],l[l.length-1])){if(l.length<4)continue}else l.push(l[0]);o.push({geom:l,is_hole:!1})}for(var u=[],h={},c=0;c<o.length;c++){h[c]||(h[c]=[]);for(var f=c+1;f<o.length;f++)y(o[f].geom[0],o[c].geom)&&(o[f].is_hole=!0,h[c].push(f))}for(var p in h)if(!o[p].is_hole){var l=[o[p].geom];h[p].forEach(function(e){l.push(o[e].geom)}),u.push(l)}return u}function i(e,t,n,r){var o=e.first;do{l(o,r);var i=t.first;if(!o.intersect)do{if(l(i,n),!i.intersect){var s=e.nextNonIntersect(o.next),u=t.nextNonIntersect(i.next),h=c(o,s,i,u);h&&(i=a(e,t,o,s,i,u,h))}i=i.next}while(i!==t.first);o=o.next}while(o!==e.first)}function s(e){var t=e.first;do t.degenerate&&(t.intersect=!0,t.neighbor.intersect=!0),t=t.next;while(t!=e.first)}function a(e,t,n,r,o,i,s){var a,l,u=0<s.alphaA&&s.alphaA<1,h=0<s.alphaB&&s.alphaB<1;return u&&h?(a=new g(s.x,s.y,s.alphaA,!0),l=new g(s.x,s.y,s.alphaB,!0),e.insert(a,n,r),t.insert(l,o,i)):(u?(a=new g(s.x,s.y,s.alphaA,!0,!0),e.insert(a,n,e.nextNonIntersect(n.next))):0==s.alphaA?(n.intersect=!0,n.degenerate=!0,n.alpha=s.alphaA,a=n):1==s.alphaA&&(r.intersect=!1,r.degenerate=!0,r.alpha=s.alphaA,a=r),h?(l=new g(s.x,s.y,s.alphaB,!0,!0),t.insert(l,o,t.nextNonIntersect(o.next))):0==s.alphaB?(o.intersect=!0,o.degenerate=!0,o.alpha=s.alphaB,l=o):1==s.alphaB&&(i.intersect=!1,i.degenerate=!0,i.alpha=s.alphaB,l=i,o.next!=t.first&&(o=o.next))),a&&l&&(a.neighbor=l,l.neighbor=a,a.type="on",l.type="on"),o}function l(e,t){e.type||(e.type=y([e.x,e.y],t)?"in":"out")}function u(e){var t=e.first,n=t;do{if(n.intersect&&n.neighbor)switch(h(n),h(n.neighbor),n.entryPair()){case"en/en":n.remove=!0,n.type="in",n.intersect=!1,n.neighbor.intersect=!1;break;case"ex/ex":n.remove=!0,n.type="out",n.intersect=!1,n.neighbor.intersect=!1}n=n.next}while(n!=t)}function h(e){var t=e.pairing();switch(t){case"in/out":case"on/out":case"in/on":e.entry=!1;break;case"out/in":case"on/in":case"out/on":e.entry=!0;break;case"out/out":case"in/in":case"on/on":var n=e.neighbor.pairing();"out/out"==n||"in/in"==n||"on/on"==n||"on/on"==t&&"on/out"==n?(e.remove=!0,e.neighbor.remove=!0,e.neighbor.intersect=!1,e.intersect=!1):(h(e.neighbor),e.entry=!e.neighbor.entry);break;default:console.error("UNKNOWN TYPE",e.pairing())}}function c(e,t,n,r){var o,i,s,a,l,u={x:null,y:null,onLine1:!1,onLine2:!1,alphaA:null,alphaB:null};return o=(r.y-n.y)*(t.x-e.x)-(r.x-n.x)*(t.y-e.y),0==o?e.equals(n)?(u.x=e.x,u.y=e.y,u.alphaA=0,u.alphaB=0,u):!1:(i=e.y-n.y,s=e.x-n.x,a=(r.x-n.x)*i-(r.y-n.y)*s,l=(t.x-e.x)*i-(t.y-e.y)*s,i=a/o,s=l/o,u.x=e.x+i*(t.x-e.x),u.y=e.y+i*(t.y-e.y),u.alphaA=i,u.alphaB=s,u.alphaA>.99999999999999&&(u.alphaA=1),u.alphaB>.99999999999999&&(u.alphaB=1),u.alphaA<1e-14&&(u.alphaA=0),u.alphaB<1e-14&&(u.alphaB=0),i>=0&&1>=i&&(u.onLine1=!0),s>=0&&1>=s&&(u.onLine2=!0),u.onLine1&&u.onLine2?u:!1)}function f(e,t){console.log("POINTS"),console.log("-----------------");var n=e.first;do n.log(),n=n.next;while(n!=e.first);if(console.log("-----------------"),t){var n=t.first;do n.log(),n=n.next;while(n!=t.first)}}var p=e("./ring"),g=e("./vertex"),y=e("point-in-polygon"),v=e("./util");t.exports=function(e,t,a,l){a=!!a,l=!!l;{var h=n(a,l),c=p.fromArray(e),g=p.fromArray(t);i(c,g,e,t)}s(c);var y;return(y=r(c,g,e,t,h))?y:(u(c),res=o(c,a,l),res&&0!=res.length||f(c,g),res)}},{"./ring":4,"./util":7,"./vertex":8,"point-in-polygon":9}],3:[function(e,t){var n=e("./greiner-hormann"),r=e("./union"),o=e("./util"),i=e("./subtract");t.exports=function(e,t){for(var e=o.clone(e),t=o.clone(t),s=o.outerHulls(e),a=o.outerHulls(t),l=o.holes(e).concat(o.holes(t)),u=[],h=0;h<s.length;h++)for(var c=0;c<a.length;c++){var f=n(s[h],a[c],!0,!0);Array.isArray(f)&&(u=u.concat(f))}if(l.length>0){var p=r(l);return i(u,o.outerHulls(p))}return u}},{"./greiner-hormann":2,"./subtract":5,"./union":6,"./util":7}],4:[function(e,t){function n(){this.first=null}var r=e("./vertex"),o=e("turf-is-clockwise");n.prototype.count=function(e,t){for(var n=this.first,r=0;;)if(e?n[e]===t&&r++:r++,n=n.next,n==this.first)break;return r},n.fromArray=function(e){var t=new n;o(e)||(e=e.reverse());for(var i=0;i<e.length-1;i++){var s=e[i];t.push(new r(s[0],s[1]))}return t},n.prototype.push=function(e){this.first?(next=this.first,prev=next.prev,next.prev=e,e.next=next,e.prev=prev,prev.next=e):(this.first=e,this.first.prev=e,this.first.next=e)},n.prototype.insert=function(e,t,n){for(var r=t.next;r!=n&&r.alpha<e.alpha;)r=r.next;e.next=r,prev=r.prev,e.prev=prev,prev.next=e,r.prev=e},n.prototype.nextNonIntersect=function(e){for(var t=e;t.intersect&&t!=this.first;)t=t.next;return t},n.prototype.firstIntersect=function(){for(var e=this.first;;){if(e.intersect&&!e.checked)return e;if(e=e.next,e==this.first)break}return!1},n.prototype.toArray=function(){var e=this.first,t=[];do t.push([e.x,e.y]),e=e.next;while(e!=this.first);return t},t.exports=n},{"./vertex":8,"turf-is-clockwise":10}],5:[function(e,t){function n(e,t){for(var n=[],r=0;r<e.length;r++)for(var o=0;o<t.length;o++){var s=i(e[r],t[o],!0,!0);Array.isArray(s)&&(n=n.concat(s))}return n}function r(e,t,s){s=!!s,e=o.clone(e),t=o.clone(t);var a=o.outerHulls(e),l=o.outerHulls(t),u=o.holes(t);if(u)var u=n(a,u);e=o.isPolygon(e)?[e]:o.wrapToPolygons(e);for(var h=0;h<l.length;h++){for(var c=e.length,f=0;f<e.length;f++){var p=i(e[f][0],l[h],!1,!0);if(0!=p.length){e[f][0]=p[0][0];for(var g=1;g<p[0].length;g++)e[f].push(p[0][g]);for(var g=1;g<p.length;g++)e.push(p[g])}else e.splice(f,1),f--}c!=e.length&&(l.splice(h,1),h--)}u.length>0&&(e=e.concat(o.wrapToPolygons(u)));var y=o.holes(e);return y.length>0&&!s?r(o.wrapToPolygons(o.outerHulls(e)),o.wrapToPolygons(y),!0):e}var o=e("./util"),i=e("./greiner-hormann");t.exports=r},{"./greiner-hormann":2,"./util":7}],6:[function(e,t){function n(e,t){for(var n=0;n<e.length;n++)for(var r=n+1;r<e.length;r++)if(n!=r){var i=o(e[n],e[r],!1,!1);1==i.length&&(e[n]=i[0][0],e.splice(r,1),r=n,i[0].length>1&&i[0].forEach(function(e,n){0!=n&&t.push(e)}))}return e}function r(e,t,n){var r=i.outerHulls(e[t]),o=i.holes(e[n]);if(o.length>0){var a=s(i.wrapToPolygons(o),r);e[n].splice(1),e[n]=e[n].concat(i.outerHulls(a))}}var o=e("./greiner-hormann"),i=e("./util"),s=e("./subtract");t.exports=function(e,t){"undefined"!=typeof t&&null!=t&&(i.isMultiPolygon(e)||(e=[e]),i.isMultiPolygon(t)||(t=[t]),e=e.concat(t)),e=i.clone(e);for(var o=0;o<e.length;o++)for(var a=o+1;a<e.length;a++)r(e,a,o),r(e,o,a);var l=i.outerHulls(e),u=i.holes(e);return l=i.wrapToPolygons(n(l,u)),u.length>0?(u=n(u),u=i.wrapToPolygons(u),s(l,u)):l}},{"./greiner-hormann":2,"./subtract":5,"./util":7}],7:[function(e,t,n){Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),n.clone=function(e){for(var t=[],r=0;r<e.length;r++)t.push(Array.isArray(e[r])?n.clone(e[r]).slice():e[r]);return t},n.wrapToPolygons=function(e){for(var t=[],r=0;r<e.length;r++)n.isRing(e[r])?t.push([e[r]]):n.isMultiPolygon(e[r])?t.concat(e[r]):n.isPolygon(e[r])&&t.push(e[r]);return t},n.unwrap=function(e){for(var t=[],n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)t.push(e[n][r])},n.depth=function(e){function t(e,n){return Array.isArray(e)?t(e[0],n+1):n}return t(e,0)},n.isMultiPolygon=function(e){return 4==n.depth(e)?!0:!1},n.isPolygon=function(e){return 3==n.depth(e)?!0:!1},n.isRing=function(e){return 2==n.depth(e)?!0:!1},n.outerHulls=function(e){var t=[];if(n.isPolygon(e))return[e[0]];for(var r=0;r<e.length;r++)if(n.isMultiPolygon(e[r]))for(var o=0;o<e[r].length;o++)t.push(e[r][o][0]);else n.isPolygon(e[r])?t.push(e[r][0]):n.isRing(e[r])&&t.push(e[r]);return t},n.holes=function(e){var t=[];if(n.isPolygon(e))return e.slice(1);for(var r=0;r<e.length;r++)if(n.isMultiPolygon(e[r]))for(var o=0;o<e[r].length;o++)for(var i=1;i<e[r][o].length;i++)t.push(e[r][o][i]);else if(n.isPolygon(e[r]))for(var o=1;o<e[r].length;o++)t.push(e[r][o]);return t},n.pointsEqual=function(e,t){return e[0]==t[0]&&e[1]==t[1]?!0:!1}},{}],8:[function(e,t){function n(e,t,n,r,o){this.x=e,this.y=t,this.alpha=n||0,this.intersect=r||!1,this.entry=!0,this.checked=!1,this.degenerate=o||!1,this.neighbor=null,this.next=null,this.prev=null,this.type=null,this.remove=!1}n.prototype.pairing=function(){return this.prev.type+"/"+this.next.type},n.prototype.entryPair=function(){var e=this.entry?"en":"ex",t=this.neighbor.entry?"en":"ex";return e+"/"+t},n.prototype.equals=function(e){return this.x==e.x&&this.y==e.y?!0:!1},n.prototype.log=function(){console.log("INTERSECT: "+(this.intersect?"Yes":"No ")+" ENTRY: "+(this.entry?"Yes":"No ")+" DEGEN: "+(this.degenerate?"Yes":"No ")+" TYPE: "+String(this.prev.type+" ").slice(0,3)+" / "+String(this.type+" ").slice(0,3)+" / "+String(this.next.type+" ").slice(0,3)+" ALPHA: "+this.alpha.toPrecision(3)+" REMOVE: "+(this.remove?"Yes":"No")+" "+this.x+", "+this.y)},t.exports=n},{}],9:[function(e,t){t.exports=function(e,t){for(var n=e[0],r=e[1],o=!1,i=0,s=t.length-1;i<t.length;s=i++){var a=t[i][0],l=t[i][1],u=t[s][0],h=t[s][1],c=l>r!=h>r&&(u-a)*(r-l)/(h-l)+a>n;c&&(o=!o)}return o}},{}],10:[function(e,t){t.exports=function(e){for(var t,n,r=0,o=1,i=e.length;i>o;)t=n||e[0],n=e[o],r+=(n[0]-t[0])*(n[1]+t[1]),o++;return r>0}},{}]},{},[1])(1)});